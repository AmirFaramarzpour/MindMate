<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mind Mate</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Zain:ital,wght@0,200;0,300;0,400;0,700;0,800;0,900;1,300;1,400&display=swap" rel="stylesheet">

<style>
    body {
        font-family: 'Zain', sans-serif;
        background-color: #001B2D;
        background-image: url("https://ik.imagekit.io/0daytaken/symmetry-geometric-colorful-lines-5k-3840x2160-7761.jpg?updatedAt=1738803213115");
        background-size: cover;
        background-position: center;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        padding: 20px;
        margin: 0;
        color: #FFFFFF;
    }

    .container {
        max-width: 800px;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.85);
        border-radius: 15px;
        padding: 20px;  /* Reduced padding to make more room */
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }

    .section {
        padding: 15px;  /* Reduced padding for tighter layout */
        background-color: #232F3B;
        border-radius: 10px;
        margin-bottom: 20px;
    }

    .chat-box {
        height: 150px;  /* Increased height of chat box */
        overflow-y: auto;
        border: 1px solid #444;
        padding: 0px;
        background-color: #2D3E50;
        border-radius: 8px;
        margin-bottom: 10px;  /* Reduced margin */
        width: 100%;
        color: #FFFFFF;
        font-size: 16px;
        font-family: 'Zain', sans-serif;
    }

    .prompt-box {
        height: 50px;  /* Smaller height for prompt box */
        overflow-y: auto;
        border: 1px solid #444;
        padding: 0px;
        background-color: #2D3E50;
        border-radius: 8px;
        margin-bottom: 15px;
        width: 100%;
        color: #FFFFFF;
        font-size: 16px;
        font-family: 'Zain', sans-serif;
    }

    .chat-box div {
        text-align: justify;
        margin-bottom: 15px;
    }

    .send-btn {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 10px;
        margin-top: 10px;
    }

    .send-btn button {
        padding: 12px 0;
        font-size: 1rem;
        border-radius: 10px;
        background-color: #A67C52;
        border: none;
        color: #FFF;
        transition: background-color 0.3s ease;
        font-family: 'Zain', sans-serif;
    }

    .send-btn button:hover {
        background-color: #9E6F3D;
    }

    p.transparent-title {
        font-family: "Rowdies", serif;
        background-color: #09122C;
        padding: 15px;
        border-radius: 10px;
        font-size: 2.2rem;  /* Slightly reduced font size for better fit */
        color: #27667B;
        margin-bottom: 20px;  /* Reduced margin to bring it closer */
        overflow-wrap: break-word;  /* Ensure text wraps if needed */
    }

    .social-icons {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
    }

    .social-icons a {
        color: #fff;
        font-size: 1.5rem;
        text-decoration: none;
    }

    .social-icons a:hover {
        color: #A67C52;
    }

    .footer-text {
        color: #FFF;
        font-size: 1rem;
        margin-top: 20px;
        text-align: center;
        font-family: 'Zain', sans-serif;
    }

    @media (max-width: 767px) {
        .container {
            padding: 15px;
        }

        p.transparent-title {
            font-size: 1.8rem;
        }

        .send-btn {
            grid-template-columns: repeat(2, 1fr);
        }

        .chat-box {
            height: 200px;  /* Adjusted for smaller screens */
        }

        .prompt-box {
            height: 80px;  /* Adjusted for smaller screens */
        }
    }
</style>
</head>
<body>
    <div class="container text-center">
        <p class="transparent-title">Mind Mate <sub style="font-size: 0.8rem;">BETA</sub></p>

        <div class="section">
            <div id="ai-response" class="chat-box"></div>
            <textarea id="ai-prompt" placeholder="Enter your message here..." class="prompt-box" rows="4"></textarea>
            <div class="send-btn">
                <button class="btn" id="ai-send-button"><i class="fas fa-paper-plane"></i> Send</button>
                <button class="btn" id="listen-button"><i class="fas fa-volume-up"></i> Listen</button>
                <button class="btn" id="mic-button"><i class="fas fa-microphone"></i> Speak</button>
                <button class="btn" id="copy-button"><i class="fas fa-copy"></i> Copy</button>
                <button class="btn" id="clear-button"><i class="fas fa-trash-alt"></i> Clear</button>
                <button class="btn" id="fullscreen-button"><i class="fas fa-expand"></i> Fullscreen</button>
                <button class="btn" id="refresh-button"><i class="fas fa-sync-alt"></i> Refresh</button>
                <button class="btn" id="download-button"><i class="fas fa-download"></i> Download</button> <!-- New Download Button -->
            </div>
        </div>

        <div class="social-icons">
            <a href="https://t.me/HotChartMusic" target="_blank"><i class="fab fa-telegram-plane"></i></a>
            <a href="https://www.youtube.com/@rootkitraven" target="_blank"><i class="fab fa-youtube"></i></a>
            <a href="https://github.com/amirfaramarzpour" target="_blank"><i class="fab fa-github"></i></a>
            <a href="https://amirfaramarzpour.ir" target="_blank"><i class="fas fa-globe"></i></a>
        </div>

        <div class="footer-text">
            &copy; "Amir Faramarzpour"<br> Home Network (LAN) OpenAI's API for GPT-4 Mini.<br> TP-LINK 150Mbps Wireless N ADSL2+ Modem Router<br>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        document.getElementById('ai-send-button').addEventListener('click', async function() {
            const prompt = document.getElementById('ai-prompt').value;
            const responseBox = document.getElementById('ai-response');
            const timestamp = new Date().toLocaleTimeString();
            if (prompt.trim() !== "") {
                responseBox.innerHTML += `<div><strong>Me (${timestamp}):</strong> ${prompt}</div>`;
                document.getElementById('ai-prompt').value = "";
                try {
                    const response = await axios.post('/api/ai', { prompt });
                    responseBox.innerHTML += `<div><strong>Mate (${new Date().toLocaleTimeString()}):</strong> ${response.data.response || response.data.error}</div>`;
                    responseBox.scrollTop = responseBox.scrollHeight;
                } catch (error) {
                    responseBox.innerHTML += `<div class="alert alert-danger">An error occurred. Please try again later.</div>`;
                }
            }
        });

        document.getElementById('copy-button').addEventListener('click', function() {
            const responseBox = document.getElementById('ai-response');
            const range = document.createRange();
            range.selectNodeContents(responseBox);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            document.execCommand('copy');
        });

        document.getElementById('clear-button').addEventListener('click', function() {
            document.getElementById('ai-response').innerHTML = "";
        });

        document.getElementById('listen-button').addEventListener('click', function() {
            const responseText = document.getElementById('ai-response').innerText;
            if (responseText.trim() !== "") {
                const speech = new SpeechSynthesisUtterance(responseText);
                speech.lang = 'en-US';
                window.speechSynthesis.speak(speech);
            }
        });

        document.getElementById('mic-button').addEventListener('click', function() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'en-US';
            recognition.start();
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                document.getElementById('ai-prompt').value += transcript;
            };
        });

        document.getElementById('fullscreen-button').addEventListener('click', function() {
            const container = document.querySelector('.container');
            if (!document.fullscreenElement) {
                container.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });

        document.getElementById('refresh-button').addEventListener('click', function() {
            location.reload();
        });

        // Download Button Functionality
        document.getElementById('download-button').addEventListener('click', function() {
            const responseBox = document.getElementById('ai-response');
            const content = responseBox.innerText;

            if (content.trim() !== "") {
                const blob = new Blob([content], { type: 'text/plain' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'chat_history.txt';
                link.click();
            } else {
                alert("No conversation to download.");
            }
        });
    </script>
</body>
</html>
